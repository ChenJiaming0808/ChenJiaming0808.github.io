# 自定义注解的场景及实现
## 一、注解的基础
1. 注解的定义：Java中叫做Annotation，用@interface表示。
2. 元注解：@interface上面按需要注解上一些东西，包括@Retention、@Target、@Document、@Inherited四种。
3. 注解的保留策略：
- @Retention(RetentionPolicy.SOURCE)   // 注解仅存在于源码中，在class字节码文件中不包含
- @Retention(RetentionPolicy.CLASS)     // 默认的保留策略，注解会在class字节码文件中存在，但运行时无法获得
- @Retention(RetentionPolicy.RUNTIME)  // 注解会在class字节码文件中存在，在运行时可以通过反射获取到
4. 注解的作用目标：
- @Target(ElementType.TYPE)                      // 接口、类、枚举、注解
- @Target(ElementType.FIELD)                     // 字段、枚举的常量
- @Target(ElementType.METHOD)                 // 方法
- @Target(ElementType.PARAMETER)            // 方法参数
- @Target(ElementType.CONSTRUCTOR)       // 构造函数
- @Target(ElementType.LOCAL_VARIABLE)   // 局部变量
- @Target(ElementType.ANNOTATION_TYPE) // 注解
- @Target(ElementType.PACKAGE)               // 包
5. 注解包含在javadoc中：
- @Documented
6. 注解可以被继承：
- @Inherited
7. 注解解析器：用来解析自定义注解。
## 二、通过注解进行赋值（结合了工厂方法模式）
1. 自定义注解
```java
import java.lang.annotation.*;

@Documented
@Inherited
@Target({ElementType.FIELD, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
public @interface Init {
    public String value() default "";
}
```
2. 在数据模型使用注解
```java
public class User {
    private String name;

    public String getName() {
        return name;
    }

    @Init(value = "vivfeng")
    public void setName(String name) {
        this.name = name;
    }
}
```
3. 用“构造工厂”充当“注解解析器”
```java
import java.lang.reflect.Method;

public class UserFactory {
    public static User create() {
        User user = new User();

        Method[] methods = User.class.getMethods();

        try {
            for (Method method : methods) {
                //如果此方法有注解，就把注解里面的数据赋值到user对象
                if (method.isAnnotationPresent(Init.class)) {
                    Init init = method.getAnnotation(Init.class);
                    method.invoke(user, init.value());
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }

        return user;
    }
}
```
4. 运行的代码
```java
public class Main {
    public static void main(String[] args) {
        User user = UserFactory.create();
        System.out.println(user.getName());
    }
}
```
5. 运行结果
```java
vivfeng
```